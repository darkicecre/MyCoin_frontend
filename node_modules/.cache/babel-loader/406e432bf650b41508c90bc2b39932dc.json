{"ast":null,"code":"import React, { Component, useState, useImperativeHandle, useContext, useRef, useEffect } from 'react';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || from);\n}\n/**\n * Rounds number to given decimal\n * eg. roundNumber(2.34343, 1) => 2.3\n */\n\n\nvar roundNumber = function (num, decimal) {\n  return Number(num.toFixed(decimal));\n};\n/**\n * Checks if value is number, if not it returns default value\n * 1# eg. checkIsNumber(2, 30) => 2\n * 2# eg. checkIsNumber(null, 30) => 30\n */\n\n\nvar checkIsNumber = function (num, defaultValue) {\n  return typeof num === \"number\" ? num : defaultValue;\n};\n\nvar handleCallback = function (context, event, callback) {\n  if (callback && typeof callback === \"function\") {\n    callback(context, event);\n  }\n};\n/**\n * Functions should return denominator of the target value, which is the next animation step.\n * t is a value from 0 to 1, reflecting the percentage of animation status.\n */\n\n\nvar easeOut = function (t) {\n  return -Math.cos(t * Math.PI) / 2 + 0.5;\n}; // linear\n\n\nvar linear = function (t) {\n  return t;\n}; // accelerating from zero velocity\n\n\nvar easeInQuad = function (t) {\n  return t * t;\n}; // decelerating to zero velocity\n\n\nvar easeOutQuad = function (t) {\n  return t * (2 - t);\n}; // acceleration until halfway, then deceleration\n\n\nvar easeInOutQuad = function (t) {\n  return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n}; // accelerating from zero velocity\n\n\nvar easeInCubic = function (t) {\n  return t * t * t;\n}; // decelerating to zero velocity\n\n\nvar easeOutCubic = function (t) {\n  return --t * t * t + 1;\n}; // acceleration until halfway, then deceleration\n\n\nvar easeInOutCubic = function (t) {\n  return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n}; // accelerating from zero velocity\n\n\nvar easeInQuart = function (t) {\n  return t * t * t * t;\n}; // decelerating to zero velocity\n\n\nvar easeOutQuart = function (t) {\n  return 1 - --t * t * t * t;\n}; // acceleration until halfway, then deceleration\n\n\nvar easeInOutQuart = function (t) {\n  return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n}; // accelerating from zero velocity\n\n\nvar easeInQuint = function (t) {\n  return t * t * t * t * t;\n}; // decelerating to zero velocity\n\n\nvar easeOutQuint = function (t) {\n  return 1 + --t * t * t * t * t;\n}; // acceleration until halfway, then deceleration\n\n\nvar easeInOutQuint = function (t) {\n  return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n};\n\nvar animations = {\n  easeOut: easeOut,\n  linear: linear,\n  easeInQuad: easeInQuad,\n  easeOutQuad: easeOutQuad,\n  easeInOutQuad: easeInOutQuad,\n  easeInCubic: easeInCubic,\n  easeOutCubic: easeOutCubic,\n  easeInOutCubic: easeInOutCubic,\n  easeInQuart: easeInQuart,\n  easeOutQuart: easeOutQuart,\n  easeInOutQuart: easeInOutQuart,\n  easeInQuint: easeInQuint,\n  easeOutQuint: easeOutQuint,\n  easeInOutQuint: easeInOutQuint\n};\n\nvar handleCancelAnimationFrame = function (animation) {\n  if (typeof animation === \"number\") {\n    cancelAnimationFrame(animation);\n  }\n};\n\nvar handleCancelAnimation = function (contextInstance) {\n  if (!contextInstance.mounted) return;\n  handleCancelAnimationFrame(contextInstance.animation); // Clear animation state\n\n  contextInstance.animate = false;\n  contextInstance.animation = null;\n  contextInstance.velocity = null;\n};\n\nfunction handleSetupAnimation(contextInstance, animationName, animationTime, callback) {\n  if (!contextInstance.mounted) return;\n  var startTime = new Date().getTime();\n  var lastStep = 1; // if another animation is active\n\n  handleCancelAnimation(contextInstance); // new animation\n\n  contextInstance.animation = function () {\n    if (!contextInstance.mounted) {\n      return handleCancelAnimationFrame(contextInstance.animation);\n    }\n\n    var frameTime = new Date().getTime() - startTime;\n    var animationProgress = frameTime / animationTime;\n    var animationType = animations[animationName];\n    var step = animationType(animationProgress);\n\n    if (frameTime >= animationTime) {\n      callback(lastStep);\n      contextInstance.animation = null;\n    } else if (contextInstance.animation) {\n      callback(step);\n      requestAnimationFrame(contextInstance.animation);\n    }\n  };\n\n  requestAnimationFrame(contextInstance.animation);\n}\n\nfunction animate(contextInstance, targetState, animationTime, animationName) {\n  var isValid = isValidTargetState(targetState);\n  if (!contextInstance.mounted || !isValid) return;\n  var setTransformState = contextInstance.setTransformState;\n  var _a = contextInstance.transformState,\n      scale = _a.scale,\n      positionX = _a.positionX,\n      positionY = _a.positionY;\n  var scaleDiff = targetState.scale - scale;\n  var positionXDiff = targetState.positionX - positionX;\n  var positionYDiff = targetState.positionY - positionY;\n\n  if (animationTime === 0) {\n    setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n  } else {\n    // animation start timestamp\n    handleSetupAnimation(contextInstance, animationName, animationTime, function (step) {\n      var newScale = scale + scaleDiff * step;\n      var newPositionX = positionX + positionXDiff * step;\n      var newPositionY = positionY + positionYDiff * step;\n      setTransformState(newScale, newPositionX, newPositionY);\n    });\n  }\n}\n\nfunction isValidTargetState(targetState) {\n  var scale = targetState.scale,\n      positionX = targetState.positionX,\n      positionY = targetState.positionY;\n\n  if (isNaN(scale) || isNaN(positionX) || isNaN(positionY)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction getComponentsSizes(wrapperComponent, contentComponent, newScale) {\n  var wrapperWidth = wrapperComponent.offsetWidth;\n  var wrapperHeight = wrapperComponent.offsetHeight;\n  var contentWidth = contentComponent.offsetWidth;\n  var contentHeight = contentComponent.offsetHeight;\n  var newContentWidth = contentWidth * newScale;\n  var newContentHeight = contentHeight * newScale;\n  var newDiffWidth = wrapperWidth - newContentWidth;\n  var newDiffHeight = wrapperHeight - newContentHeight;\n  return {\n    wrapperWidth: wrapperWidth,\n    wrapperHeight: wrapperHeight,\n    newContentWidth: newContentWidth,\n    newDiffWidth: newDiffWidth,\n    newContentHeight: newContentHeight,\n    newDiffHeight: newDiffHeight\n  };\n}\n\nvar getBounds = function (wrapperWidth, newContentWidth, diffWidth, wrapperHeight, newContentHeight, diffHeight, centerZoomedOut) {\n  var scaleWidthFactor = wrapperWidth > newContentWidth ? diffWidth * (centerZoomedOut ? 1 : 0.5) : 0;\n  var scaleHeightFactor = wrapperHeight > newContentHeight ? diffHeight * (centerZoomedOut ? 1 : 0.5) : 0;\n  var minPositionX = wrapperWidth - newContentWidth - scaleWidthFactor;\n  var maxPositionX = scaleWidthFactor;\n  var minPositionY = wrapperHeight - newContentHeight - scaleHeightFactor;\n  var maxPositionY = scaleHeightFactor;\n  return {\n    minPositionX: minPositionX,\n    maxPositionX: maxPositionX,\n    minPositionY: minPositionY,\n    maxPositionY: maxPositionY\n  };\n};\n\nvar calculateBounds = function (contextInstance, newScale) {\n  var wrapperComponent = contextInstance.wrapperComponent,\n      contentComponent = contextInstance.contentComponent;\n  var centerZoomedOut = contextInstance.setup.centerZoomedOut;\n\n  if (!wrapperComponent || !contentComponent) {\n    throw new Error(\"Components are not mounted\");\n  }\n\n  var _a = getComponentsSizes(wrapperComponent, contentComponent, newScale),\n      wrapperWidth = _a.wrapperWidth,\n      wrapperHeight = _a.wrapperHeight,\n      newContentWidth = _a.newContentWidth,\n      newDiffWidth = _a.newDiffWidth,\n      newContentHeight = _a.newContentHeight,\n      newDiffHeight = _a.newDiffHeight;\n\n  var bounds = getBounds(wrapperWidth, newContentWidth, newDiffWidth, wrapperHeight, newContentHeight, newDiffHeight, Boolean(centerZoomedOut));\n  return bounds;\n};\n\nvar handleCalculateBounds = function (contextInstance, newScale) {\n  var bounds = calculateBounds(contextInstance, newScale); // Save bounds\n\n  contextInstance.bounds = bounds;\n  return bounds;\n};\n\nfunction getMouseBoundedPosition(positionX, positionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent) {\n  var minPositionX = bounds.minPositionX,\n      minPositionY = bounds.minPositionY,\n      maxPositionX = bounds.maxPositionX,\n      maxPositionY = bounds.maxPositionY;\n  var paddingX = 0;\n  var paddingY = 0;\n\n  if (wrapperComponent) {\n    paddingX = paddingValueX;\n    paddingY = paddingValueY;\n  }\n\n  var x = boundLimiter(positionX, minPositionX - paddingX, maxPositionX + paddingX, limitToBounds);\n  var y = boundLimiter(positionY, minPositionY - paddingY, maxPositionY + paddingY, limitToBounds);\n  return {\n    x: x,\n    y: y\n  };\n}\n/**\n * Keeps value between given bounds, used for limiting view to given boundaries\n * 1# eg. boundLimiter(2, 0, 3, true) => 2\n * 2# eg. boundLimiter(4, 0, 3, true) => 3\n * 3# eg. boundLimiter(-2, 0, 3, true) => 0\n * 4# eg. boundLimiter(10, 0, 3, false) => 10\n */\n\n\nvar boundLimiter = function (value, minBound, maxBound, isActive) {\n  if (!isActive) return roundNumber(value, 2);\n  if (value < minBound) return roundNumber(minBound, 2);\n  if (value > maxBound) return roundNumber(maxBound, 2);\n  return roundNumber(value, 2);\n};\n\nfunction handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds) {\n  var _a = contextInstance.transformState,\n      scale = _a.scale,\n      positionX = _a.positionX,\n      positionY = _a.positionY;\n  var scaleDifference = newScale - scale;\n\n  if (typeof mouseX !== \"number\" || typeof mouseY !== \"number\") {\n    console.error(\"Mouse X and Y position were not provided!\");\n    return {\n      x: positionX,\n      y: positionY\n    };\n  }\n\n  var calculatedPositionX = positionX - mouseX * scaleDifference;\n  var calculatedPositionY = positionY - mouseY * scaleDifference; // do not limit to bounds when there is padding animation,\n  // it causes animation strange behaviour\n\n  var newPositions = getMouseBoundedPosition(calculatedPositionX, calculatedPositionY, bounds, limitToBounds, 0, 0, null);\n  return newPositions;\n}\n\nfunction checkZoomBounds(zoom, minScale, maxScale, zoomPadding, enablePadding) {\n  var scalePadding = enablePadding ? zoomPadding : 0;\n  var minScaleWithPadding = minScale - scalePadding;\n  if (!isNaN(maxScale) && zoom >= maxScale) return maxScale;\n  if (!isNaN(minScale) && zoom <= minScaleWithPadding) return minScaleWithPadding;\n  return zoom;\n}\n\nvar isPanningStartAllowed = function (contextInstance, event) {\n  var excluded = contextInstance.setup.panning.excluded;\n  var isInitialized = contextInstance.isInitialized,\n      wrapperComponent = contextInstance.wrapperComponent;\n  var target = event.target;\n  var isWrapperChild = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n  var isAllowed = isInitialized && target && isWrapperChild;\n  if (!isAllowed) return false;\n  var isExcluded = isExcludedNode(target, excluded);\n  if (isExcluded) return false;\n  return true;\n};\n\nvar isPanningAllowed = function (contextInstance) {\n  var isInitialized = contextInstance.isInitialized,\n      isPanning = contextInstance.isPanning,\n      setup = contextInstance.setup;\n  var disabled = setup.panning.disabled;\n  var isAllowed = isInitialized && isPanning && !disabled;\n  if (!isAllowed) return false;\n  return true;\n};\n\nvar handlePanningSetup = function (contextInstance, event) {\n  var _a = contextInstance.transformState,\n      positionX = _a.positionX,\n      positionY = _a.positionY;\n  contextInstance.isPanning = true; // Panning with mouse\n\n  var x = event.clientX;\n  var y = event.clientY;\n  contextInstance.startCoords = {\n    x: x - positionX,\n    y: y - positionY\n  };\n};\n\nvar handleTouchPanningSetup = function (contextInstance, event) {\n  var touches = event.touches;\n  var _a = contextInstance.transformState,\n      positionX = _a.positionX,\n      positionY = _a.positionY;\n  contextInstance.isPanning = true; // Panning with touch\n\n  var oneFingerTouch = touches.length === 1;\n\n  if (oneFingerTouch) {\n    var x = touches[0].clientX;\n    var y = touches[0].clientY;\n    contextInstance.startCoords = {\n      x: x - positionX,\n      y: y - positionY\n    };\n  }\n};\n\nfunction handlePanToBounds(contextInstance) {\n  var _a = contextInstance.transformState,\n      positionX = _a.positionX,\n      positionY = _a.positionY,\n      scale = _a.scale;\n  var _b = contextInstance.setup,\n      disabled = _b.disabled,\n      limitToBounds = _b.limitToBounds,\n      centerZoomedOut = _b.centerZoomedOut;\n  var wrapperComponent = contextInstance.wrapperComponent;\n  if (disabled || !wrapperComponent || !contextInstance.bounds) return;\n  var _c = contextInstance.bounds,\n      maxPositionX = _c.maxPositionX,\n      minPositionX = _c.minPositionX,\n      maxPositionY = _c.maxPositionY,\n      minPositionY = _c.minPositionY;\n  var xChanged = positionX > maxPositionX || positionX < minPositionX;\n  var yChanged = positionY > maxPositionY || positionY < minPositionY;\n  var mousePosX = positionX > maxPositionX ? wrapperComponent.offsetWidth : contextInstance.setup.minPositionX || 0;\n  var mousePosY = positionY > maxPositionY ? wrapperComponent.offsetHeight : contextInstance.setup.minPositionY || 0;\n\n  var _d = handleCalculateZoomPositions(contextInstance, mousePosX, mousePosY, scale, contextInstance.bounds, limitToBounds || centerZoomedOut),\n      x = _d.x,\n      y = _d.y;\n\n  return {\n    scale: scale,\n    positionX: xChanged ? x : positionX,\n    positionY: yChanged ? y : positionY\n  };\n}\n\nfunction handleNewPosition(contextInstance, newPositionX, newPositionY, paddingValueX, paddingValueY) {\n  var limitToBounds = contextInstance.setup.limitToBounds;\n  var wrapperComponent = contextInstance.wrapperComponent,\n      bounds = contextInstance.bounds;\n  var _a = contextInstance.transformState,\n      scale = _a.scale,\n      positionX = _a.positionX,\n      positionY = _a.positionY;\n  var hasPositionXChanged = newPositionX !== positionX;\n  var hasPositionYChanged = newPositionY !== positionY;\n  var hasNewPosition = !hasPositionXChanged || !hasPositionYChanged;\n\n  if (!wrapperComponent || hasNewPosition || !bounds) {\n    return;\n  }\n\n  var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent),\n      x = _b.x,\n      y = _b.y;\n\n  contextInstance.setTransformState(scale, x, y);\n}\n\nvar getPanningClientPosition = function (contextInstance, clientX, clientY) {\n  var startCoords = contextInstance.startCoords,\n      transformState = contextInstance.transformState;\n  var panning = contextInstance.setup.panning;\n  var lockAxisX = panning.lockAxisX,\n      lockAxisY = panning.lockAxisY;\n  var positionX = transformState.positionX,\n      positionY = transformState.positionY;\n\n  if (!startCoords) {\n    return {\n      x: positionX,\n      y: positionY\n    };\n  }\n\n  var mouseX = clientX - startCoords.x;\n  var mouseY = clientY - startCoords.y;\n  var newPositionX = lockAxisX ? positionX : mouseX;\n  var newPositionY = lockAxisY ? positionY : mouseY;\n  return {\n    x: newPositionX,\n    y: newPositionY\n  };\n};\n\nvar getPaddingValue = function (contextInstance, size) {\n  var setup = contextInstance.setup,\n      transformState = contextInstance.transformState;\n  var scale = transformState.scale;\n  var minScale = setup.minScale;\n\n  if (size > 0 && scale >= minScale) {\n    return size;\n  }\n\n  return 0;\n};\n\nvar isVelocityCalculationAllowed = function (contextInstance) {\n  var mounted = contextInstance.mounted;\n  var _a = contextInstance.setup,\n      disabled = _a.disabled,\n      velocityAnimation = _a.velocityAnimation;\n  var scale = contextInstance.transformState.scale;\n  var disabledVelocity = velocityAnimation.disabled;\n  var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n  if (!isAllowed) return false;\n  return true;\n};\n\nvar isVelocityAllowed = function (contextInstance) {\n  var mounted = contextInstance.mounted,\n      velocity = contextInstance.velocity,\n      bounds = contextInstance.bounds;\n  var _a = contextInstance.setup,\n      disabled = _a.disabled,\n      velocityAnimation = _a.velocityAnimation;\n  var scale = contextInstance.transformState.scale;\n  var disabledVelocity = velocityAnimation.disabled;\n  var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n  if (!isAllowed) return false;\n  if (!velocity || !bounds) return false;\n  return true;\n};\n\nfunction getVelocityMoveTime(contextInstance, velocity) {\n  var velocityAnimation = contextInstance.setup.velocityAnimation;\n  var equalToMove = velocityAnimation.equalToMove,\n      animationTime = velocityAnimation.animationTime,\n      sensitivity = velocityAnimation.sensitivity;\n\n  if (equalToMove) {\n    return animationTime * velocity * sensitivity;\n  }\n\n  return animationTime;\n}\n\nfunction getVelocityPosition(newPosition, startPosition, currentPosition, isLocked, limitToBounds, minPosition, maxPosition, minTarget, maxTarget, step) {\n  if (limitToBounds) {\n    if (startPosition > maxPosition && currentPosition > maxPosition) {\n      var calculatedPosition = maxPosition + (newPosition - maxPosition) * step;\n      if (calculatedPosition > maxTarget) return maxTarget;\n      if (calculatedPosition < maxPosition) return maxPosition;\n      return calculatedPosition;\n    }\n\n    if (startPosition < minPosition && currentPosition < minPosition) {\n      var calculatedPosition = minPosition + (newPosition - minPosition) * step;\n      if (calculatedPosition < minTarget) return minTarget;\n      if (calculatedPosition > minPosition) return minPosition;\n      return calculatedPosition;\n    }\n  }\n\n  if (isLocked) return startPosition;\n  return boundLimiter(newPosition, minPosition, maxPosition, limitToBounds);\n}\n\nfunction getSizeMultiplier(wrapperComponent, equalToMove) {\n  var defaultMultiplier = 1;\n\n  if (equalToMove) {\n    return Math.min(defaultMultiplier, wrapperComponent.offsetWidth / window.innerWidth);\n  }\n\n  return defaultMultiplier;\n}\n\nfunction handleCalculateVelocity(contextInstance, position) {\n  var isAllowed = isVelocityCalculationAllowed(contextInstance);\n\n  if (!isAllowed) {\n    return;\n  }\n\n  var lastMousePosition = contextInstance.lastMousePosition,\n      velocityTime = contextInstance.velocityTime,\n      setup = contextInstance.setup;\n  var wrapperComponent = contextInstance.wrapperComponent;\n  var equalToMove = setup.velocityAnimation.equalToMove;\n  var now = Date.now();\n\n  if (lastMousePosition && velocityTime && wrapperComponent) {\n    var sizeMultiplier = getSizeMultiplier(wrapperComponent, equalToMove);\n    var distanceX = position.x - lastMousePosition.x;\n    var distanceY = position.y - lastMousePosition.y;\n    var velocityX = distanceX / sizeMultiplier;\n    var velocityY = distanceY / sizeMultiplier;\n    var interval = now - velocityTime;\n    var speed = distanceX * distanceX + distanceY * distanceY;\n    var velocity = Math.sqrt(speed) / interval;\n    contextInstance.velocity = {\n      velocityX: velocityX,\n      velocityY: velocityY,\n      total: velocity\n    };\n  }\n\n  contextInstance.lastMousePosition = position;\n  contextInstance.velocityTime = now;\n}\n\nfunction handleVelocityPanning(contextInstance) {\n  var velocity = contextInstance.velocity,\n      bounds = contextInstance.bounds,\n      setup = contextInstance.setup,\n      wrapperComponent = contextInstance.wrapperComponent;\n  var isAllowed = isVelocityAllowed(contextInstance);\n\n  if (!isAllowed || !velocity || !bounds || !wrapperComponent) {\n    return;\n  }\n\n  var velocityX = velocity.velocityX,\n      velocityY = velocity.velocityY,\n      total = velocity.total;\n  var maxPositionX = bounds.maxPositionX,\n      minPositionX = bounds.minPositionX,\n      maxPositionY = bounds.maxPositionY,\n      minPositionY = bounds.minPositionY;\n  var limitToBounds = setup.limitToBounds,\n      alignmentAnimation = setup.alignmentAnimation;\n  var zoomAnimation = setup.zoomAnimation,\n      panning = setup.panning;\n  var lockAxisY = panning.lockAxisY,\n      lockAxisX = panning.lockAxisX;\n  var animationType = zoomAnimation.animationType;\n  var sizeX = alignmentAnimation.sizeX,\n      sizeY = alignmentAnimation.sizeY,\n      velocityAlignmentTime = alignmentAnimation.velocityAlignmentTime;\n  var alignAnimationTime = velocityAlignmentTime;\n  var moveAnimationTime = getVelocityMoveTime(contextInstance, total);\n  var finalAnimationTime = Math.max(moveAnimationTime, alignAnimationTime);\n  var paddingValueX = getPaddingValue(contextInstance, sizeX);\n  var paddingValueY = getPaddingValue(contextInstance, sizeY);\n  var paddingX = paddingValueX * wrapperComponent.offsetWidth / 100;\n  var paddingY = paddingValueY * wrapperComponent.offsetHeight / 100;\n  var maxTargetX = maxPositionX + paddingX;\n  var minTargetX = minPositionX - paddingX;\n  var maxTargetY = maxPositionY + paddingY;\n  var minTargetY = minPositionY - paddingY;\n  var startState = contextInstance.transformState;\n  var startTime = new Date().getTime();\n  handleSetupAnimation(contextInstance, animationType, finalAnimationTime, function (step) {\n    var _a = contextInstance.transformState,\n        scale = _a.scale,\n        positionX = _a.positionX,\n        positionY = _a.positionY;\n    var frameTime = new Date().getTime() - startTime;\n    var animationProgress = frameTime / alignAnimationTime;\n    var alignAnimation = animations[alignmentAnimation.animationType];\n    var alignStep = 1 - alignAnimation(Math.min(1, animationProgress));\n    var customStep = 1 - step;\n    var newPositionX = positionX + velocityX * customStep;\n    var newPositionY = positionY + velocityY * customStep;\n    var currentPositionX = getVelocityPosition(newPositionX, startState.positionX, positionX, lockAxisX, limitToBounds, minPositionX, maxPositionX, minTargetX, maxTargetX, alignStep);\n    var currentPositionY = getVelocityPosition(newPositionY, startState.positionY, positionY, lockAxisY, limitToBounds, minPositionY, maxPositionY, minTargetY, maxTargetY, alignStep);\n\n    if (positionX !== newPositionX || positionY !== newPositionY) {\n      contextInstance.setTransformState(scale, currentPositionX, currentPositionY);\n    }\n  });\n}\n\nfunction handlePanningStart(contextInstance, event) {\n  var scale = contextInstance.transformState.scale;\n  handleCancelAnimation(contextInstance);\n  handleCalculateBounds(contextInstance, scale);\n\n  if (event.touches) {\n    handleTouchPanningSetup(contextInstance, event);\n  } else {\n    handlePanningSetup(contextInstance, event);\n  }\n}\n\nfunction handlePanning(contextInstance, clientX, clientY) {\n  var startCoords = contextInstance.startCoords,\n      setup = contextInstance.setup;\n  var _a = setup.alignmentAnimation,\n      sizeX = _a.sizeX,\n      sizeY = _a.sizeY;\n  if (!startCoords) return;\n\n  var _b = getPanningClientPosition(contextInstance, clientX, clientY),\n      x = _b.x,\n      y = _b.y;\n\n  var paddingValueX = getPaddingValue(contextInstance, sizeX);\n  var paddingValueY = getPaddingValue(contextInstance, sizeY);\n  handleCalculateVelocity(contextInstance, {\n    x: x,\n    y: y\n  });\n  handleNewPosition(contextInstance, x, y, paddingValueX, paddingValueY);\n}\n\nfunction handlePanningEnd(contextInstance) {\n  if (contextInstance.isPanning) {\n    var velocityDisabled = contextInstance.setup.panning.velocityDisabled;\n    var velocity = contextInstance.velocity,\n        wrapperComponent = contextInstance.wrapperComponent,\n        contentComponent = contextInstance.contentComponent;\n    contextInstance.isPanning = false;\n    contextInstance.animate = false;\n    contextInstance.animation = null;\n    var wrapperRect = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.getBoundingClientRect();\n    var contentRect = contentComponent === null || contentComponent === void 0 ? void 0 : contentComponent.getBoundingClientRect();\n    var wrapperWidth = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.width) || 0;\n    var wrapperHeight = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.height) || 0;\n    var contentWidth = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.width) || 0;\n    var contentHeight = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.height) || 0;\n    var isZoomed = wrapperWidth < contentWidth || wrapperHeight < contentHeight;\n    var shouldAnimate = !velocityDisabled && velocity && (velocity === null || velocity === void 0 ? void 0 : velocity.total) > 0.1 && isZoomed;\n\n    if (shouldAnimate) {\n      handleVelocityPanning(contextInstance);\n    } else {\n      handleAlignToBounds(contextInstance);\n    }\n  }\n}\n\nfunction handleAlignToBounds(contextInstance) {\n  var scale = contextInstance.transformState.scale;\n  var _a = contextInstance.setup,\n      minScale = _a.minScale,\n      alignmentAnimation = _a.alignmentAnimation;\n  var disabled = alignmentAnimation.disabled,\n      sizeX = alignmentAnimation.sizeX,\n      sizeY = alignmentAnimation.sizeY,\n      animationTime = alignmentAnimation.animationTime,\n      animationType = alignmentAnimation.animationType;\n  var isDisabled = disabled || scale < minScale || !sizeX && !sizeY;\n  if (isDisabled) return;\n  var targetState = handlePanToBounds(contextInstance);\n\n  if (targetState) {\n    animate(contextInstance, targetState, animationTime, animationType);\n  }\n}\n\nfunction handleAlignToScaleBounds(contextInstance, mousePositionX, mousePositionY) {\n  var scale = contextInstance.transformState.scale;\n  var wrapperComponent = contextInstance.wrapperComponent;\n  var _a = contextInstance.setup,\n      minScale = _a.minScale,\n      limitToBounds = _a.limitToBounds,\n      zoomAnimation = _a.zoomAnimation;\n  var disabled = zoomAnimation.disabled,\n      animationTime = zoomAnimation.animationTime,\n      animationType = zoomAnimation.animationType;\n  var isDisabled = disabled || scale >= minScale;\n\n  if (scale >= 1 || limitToBounds) {\n    // fire fit to bounds animation\n    handleAlignToBounds(contextInstance);\n  }\n\n  if (isDisabled || !wrapperComponent || !contextInstance.mounted) return;\n  var mouseX = mousePositionX || wrapperComponent.offsetWidth / 2;\n  var mouseY = mousePositionY || wrapperComponent.offsetHeight / 2;\n  var targetState = handleZoomToPoint(contextInstance, minScale, mouseX, mouseY);\n\n  if (targetState) {\n    animate(contextInstance, targetState, animationTime, animationType);\n  }\n}\n\nfunction handleZoomToPoint(contextInstance, scale, mouseX, mouseY) {\n  var _a = contextInstance.setup,\n      minScale = _a.minScale,\n      maxScale = _a.maxScale,\n      limitToBounds = _a.limitToBounds;\n  var newScale = checkZoomBounds(roundNumber(scale, 2), minScale, maxScale, 0, false);\n  var bounds = handleCalculateBounds(contextInstance, newScale);\n\n  var _b = handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds),\n      x = _b.x,\n      y = _b.y;\n\n  return {\n    scale: newScale,\n    positionX: x,\n    positionY: y\n  };\n}\n\nvar initialState = {\n  previousScale: 1,\n  scale: 1,\n  positionX: 0,\n  positionY: 0\n};\n\nvar contextInitialState = __assign(__assign({}, initialState), {\n  setComponents: function () {\n    return undefined;\n  },\n  contextInstance: null\n});\n\nvar initialSetup = {\n  disabled: false,\n  minPositionX: null,\n  maxPositionX: null,\n  minPositionY: null,\n  maxPositionY: null,\n  minScale: 1,\n  maxScale: 8,\n  limitToBounds: true,\n  centerZoomedOut: false,\n  centerOnInit: false,\n  wheel: {\n    step: 0.2,\n    disabled: false,\n    wheelDisabled: false,\n    touchPadDisabled: false,\n    activationKeys: [],\n    excluded: []\n  },\n  panning: {\n    disabled: false,\n    velocityDisabled: false,\n    lockAxisX: false,\n    lockAxisY: false,\n    activationKeys: [],\n    excluded: []\n  },\n  pinch: {\n    step: 5,\n    disabled: false,\n    excluded: []\n  },\n  doubleClick: {\n    disabled: false,\n    step: 0.7,\n    mode: \"zoomIn\",\n    animationType: \"easeOut\",\n    animationTime: 200,\n    excluded: []\n  },\n  zoomAnimation: {\n    disabled: false,\n    size: 0.4,\n    animationTime: 200,\n    animationType: \"easeOut\"\n  },\n  alignmentAnimation: {\n    disabled: false,\n    sizeX: 100,\n    sizeY: 100,\n    animationTime: 200,\n    velocityAlignmentTime: 400,\n    animationType: \"easeOut\"\n  },\n  velocityAnimation: {\n    disabled: false,\n    sensitivity: 1,\n    animationTime: 400,\n    animationType: \"easeOut\",\n    equalToMove: true\n  }\n};\n\nvar createState = function (props) {\n  var _a, _b, _c, _d;\n\n  return {\n    previousScale: (_a = props.initialScale) !== null && _a !== void 0 ? _a : initialState.scale,\n    scale: (_b = props.initialScale) !== null && _b !== void 0 ? _b : initialState.scale,\n    positionX: (_c = props.initialPositionX) !== null && _c !== void 0 ? _c : initialState.positionX,\n    positionY: (_d = props.initialPositionY) !== null && _d !== void 0 ? _d : initialState.positionY\n  };\n};\n\nvar createSetup = function (props) {\n  var newSetup = __assign({}, initialSetup);\n\n  Object.keys(props).forEach(function (key) {\n    var validValue = typeof props[key] !== \"undefined\";\n    var validParameter = typeof initialSetup[key] !== \"undefined\";\n\n    if (validParameter && validValue) {\n      var dataType = Object.prototype.toString.call(initialSetup[key]);\n      var isObject = dataType === \"[object Object]\";\n      var isArray = dataType === \"[object Array]\";\n\n      if (isObject) {\n        newSetup[key] = __assign(__assign({}, initialSetup[key]), props[key]);\n      } else if (isArray) {\n        newSetup[key] = __spreadArray(__spreadArray([], initialSetup[key]), props[key]);\n      } else {\n        newSetup[key] = props[key];\n      }\n    }\n  });\n  return newSetup;\n};\n\nvar handleCalculateButtonZoom = function (contextInstance, delta, step) {\n  var scale = contextInstance.transformState.scale;\n  var wrapperComponent = contextInstance.wrapperComponent,\n      setup = contextInstance.setup;\n  var maxScale = setup.maxScale,\n      minScale = setup.minScale,\n      zoomAnimation = setup.zoomAnimation;\n  var size = zoomAnimation.size;\n\n  if (!wrapperComponent) {\n    throw new Error(\"Wrapper is not mounted\");\n  }\n\n  var targetScale = scale * Math.exp(delta * step);\n  var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, false);\n  return newScale;\n};\n\nfunction handleZoomToViewCenter(contextInstance, delta, step, animationTime, animationType) {\n  var wrapperComponent = contextInstance.wrapperComponent;\n  var _a = contextInstance.transformState,\n      scale = _a.scale,\n      positionX = _a.positionX,\n      positionY = _a.positionY;\n  if (!wrapperComponent) return console.error(\"No WrapperComponent found\");\n  var wrapperWidth = wrapperComponent.offsetWidth;\n  var wrapperHeight = wrapperComponent.offsetHeight;\n  var mouseX = (wrapperWidth / 2 - positionX) / scale;\n  var mouseY = (wrapperHeight / 2 - positionY) / scale;\n  var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n  var targetState = handleZoomToPoint(contextInstance, newScale, mouseX, mouseY);\n\n  if (!targetState) {\n    return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n  }\n\n  animate(contextInstance, targetState, animationTime, animationType);\n}\n\nfunction resetTransformations(contextInstance, animationTime, animationType) {\n  var setup = contextInstance.setup,\n      wrapperComponent = contextInstance.wrapperComponent;\n  var limitToBounds = setup.limitToBounds;\n  var initialTransformation = createState(contextInstance.props);\n  var _a = contextInstance.transformState,\n      scale = _a.scale,\n      positionX = _a.positionX,\n      positionY = _a.positionY;\n  if (!wrapperComponent) return;\n  var newBounds = calculateBounds(contextInstance, initialTransformation.scale);\n  var boundedPositions = getMouseBoundedPosition(initialTransformation.positionX, initialTransformation.positionY, newBounds, limitToBounds, 0, 0, wrapperComponent);\n  var newState = {\n    scale: initialTransformation.scale,\n    positionX: boundedPositions.x,\n    positionY: boundedPositions.y\n  };\n\n  if (scale === initialTransformation.scale && positionX === initialTransformation.positionX && positionY === initialTransformation.positionY) {\n    return;\n  }\n\n  animate(contextInstance, newState, animationTime, animationType);\n}\n\nfunction calculateZoomToNode(contextInstance, node, customZoom) {\n  var wrapperComponent = contextInstance.wrapperComponent;\n  var _a = contextInstance.setup,\n      limitToBounds = _a.limitToBounds,\n      minScale = _a.minScale,\n      maxScale = _a.maxScale;\n  if (!wrapperComponent) return initialState;\n  var wrapperRect = wrapperComponent.getBoundingClientRect();\n  var nodeRect = getOffset(node);\n  var nodeLeft = nodeRect.x;\n  var nodeTop = nodeRect.y;\n  var nodeWidth = node.offsetWidth;\n  var nodeHeight = node.offsetHeight;\n  var scaleX = wrapperComponent.offsetWidth / nodeWidth;\n  var scaleY = wrapperComponent.offsetHeight / nodeHeight;\n  var newScale = checkZoomBounds(customZoom || Math.min(scaleX, scaleY), minScale, maxScale, 0, false);\n  var offsetX = (wrapperRect.width - nodeWidth * newScale) / 2;\n  var offsetY = (wrapperRect.height - nodeHeight * newScale) / 2;\n  var newPositionX = (wrapperRect.left - nodeLeft) * newScale + offsetX;\n  var newPositionY = (wrapperRect.top - nodeTop) * newScale + offsetY;\n  var bounds = calculateBounds(contextInstance, newScale);\n\n  var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, 0, 0, wrapperComponent),\n      x = _b.x,\n      y = _b.y;\n\n  return {\n    positionX: x,\n    positionY: y,\n    scale: newScale\n  };\n}\n\nfunction getOffset(element) {\n  var el = element;\n  var offsetLeft = 0;\n  var offsetTop = 0;\n\n  while (el) {\n    offsetLeft += el.offsetLeft;\n    offsetTop += el.offsetTop;\n    el = el.offsetParent;\n  }\n\n  return {\n    x: offsetLeft,\n    y: offsetTop\n  };\n}\n\nfunction isValidZoomNode(node) {\n  if (!node) {\n    console.error(\"Zoom node not found\");\n    return false;\n  } else if ((node === null || node === void 0 ? void 0 : node.offsetWidth) === undefined || (node === null || node === void 0 ? void 0 : node.offsetHeight) === undefined) {\n    console.error(\"Zoom node is not valid - it must contain offsetWidth and offsetHeight\");\n    return false;\n  }\n\n  return true;\n}\n\nvar zoomIn = function (contextInstance) {\n  return function (step, animationTime, animationType) {\n    if (step === void 0) {\n      step = 0.5;\n    }\n\n    if (animationTime === void 0) {\n      animationTime = 300;\n    }\n\n    if (animationType === void 0) {\n      animationType = \"easeOut\";\n    }\n\n    handleZoomToViewCenter(contextInstance, 1, step, animationTime, animationType);\n  };\n};\n\nvar zoomOut = function (contextInstance) {\n  return function (step, animationTime, animationType) {\n    if (step === void 0) {\n      step = 0.5;\n    }\n\n    if (animationTime === void 0) {\n      animationTime = 300;\n    }\n\n    if (animationType === void 0) {\n      animationType = \"easeOut\";\n    }\n\n    handleZoomToViewCenter(contextInstance, -1, step, animationTime, animationType);\n  };\n};\n\nvar setTransform = function (contextInstance) {\n  return function (newPositionX, newPositionY, newScale, animationTime, animationType) {\n    if (animationTime === void 0) {\n      animationTime = 300;\n    }\n\n    if (animationType === void 0) {\n      animationType = \"easeOut\";\n    }\n\n    var _a = contextInstance.transformState,\n        positionX = _a.positionX,\n        positionY = _a.positionY,\n        scale = _a.scale;\n    var wrapperComponent = contextInstance.wrapperComponent,\n        contentComponent = contextInstance.contentComponent;\n    var disabled = contextInstance.setup.disabled;\n    if (disabled || !wrapperComponent || !contentComponent) return;\n    var targetState = {\n      positionX: isNaN(newPositionX) ? positionX : newPositionX,\n      positionY: isNaN(newPositionY) ? positionY : newPositionY,\n      scale: isNaN(newScale) ? scale : newScale\n    };\n    animate(contextInstance, targetState, animationTime, animationType);\n  };\n};\n\nvar resetTransform = function (contextInstance) {\n  return function (animationTime, animationType) {\n    if (animationTime === void 0) {\n      animationTime = 200;\n    }\n\n    if (animationType === void 0) {\n      animationType = \"easeOut\";\n    }\n\n    resetTransformations(contextInstance, animationTime, animationType);\n  };\n};\n\nvar centerView = function (contextInstance) {\n  return function (scale, animationTime, animationType) {\n    if (animationTime === void 0) {\n      animationTime = 200;\n    }\n\n    if (animationType === void 0) {\n      animationType = \"easeOut\";\n    }\n\n    var transformState = contextInstance.transformState,\n        wrapperComponent = contextInstance.wrapperComponent,\n        contentComponent = contextInstance.contentComponent;\n\n    if (wrapperComponent && contentComponent) {\n      var targetState = getCenterPosition(scale || transformState.scale, wrapperComponent, contentComponent);\n      animate(contextInstance, targetState, animationTime, animationType);\n    }\n  };\n};\n\nvar zoomToElement = function (contextInstance) {\n  return function (node, scale, animationTime, animationType) {\n    if (animationTime === void 0) {\n      animationTime = 600;\n    }\n\n    if (animationType === void 0) {\n      animationType = \"easeOut\";\n    }\n\n    handleCancelAnimation(contextInstance);\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var target = typeof node === \"string\" ? document.getElementById(node) : node;\n\n    if (wrapperComponent && isValidZoomNode(target) && target && wrapperComponent.contains(target)) {\n      var targetState = calculateZoomToNode(contextInstance, target, scale);\n      animate(contextInstance, targetState, animationTime, animationType);\n    }\n  };\n};\n\nvar getContext = function (contextInstance) {\n  return {\n    instance: contextInstance,\n    state: contextInstance.transformState,\n    zoomIn: zoomIn(contextInstance),\n    zoomOut: zoomOut(contextInstance),\n    setTransform: setTransform(contextInstance),\n    resetTransform: resetTransform(contextInstance),\n    centerView: centerView(contextInstance),\n    zoomToElement: zoomToElement(contextInstance)\n  };\n}; // We want to make event listeners non-passive, and to do so have to check\n// that browsers support EventListenerOptions in the first place.\n// https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Safely_detecting_option_support\n\n\nvar passiveSupported = false;\n\nfunction makePassiveEventOption() {\n  try {\n    var options = {\n      get passive() {\n        // This function will be called when the browser\n        //   attempts to access the passive property.\n        passiveSupported = true;\n        return false;\n      }\n\n    };\n    return options;\n  } catch (err) {\n    passiveSupported = false;\n    return passiveSupported;\n  }\n}\n\nvar isExcludedNode = function (node, excluded) {\n  var targetTagName = node.tagName.toUpperCase();\n  var isExcludedTag = excluded.find(function (tag) {\n    return tag.toUpperCase() === targetTagName;\n  });\n  if (isExcludedTag) return true;\n  var isExcludedClassName = excluded.find(function (className) {\n    return node.classList.contains(className);\n  });\n  if (isExcludedClassName) return true;\n  return false;\n};\n\nvar cancelTimeout = function (timeout) {\n  if (timeout) {\n    clearTimeout(timeout);\n  }\n};\n\nvar getTransformStyles = function (x, y, scale) {\n  return \"translate3d(\" + x + \"px, \" + y + \"px, 0) scale(\" + scale + \")\";\n};\n\nvar getCenterPosition = function (scale, wrapperComponent, contentComponent) {\n  var contentWidth = contentComponent.offsetWidth * scale;\n  var contentHeight = contentComponent.offsetHeight * scale;\n  var centerPositionX = (wrapperComponent.offsetWidth - contentWidth) / 2;\n  var centerPositionY = (wrapperComponent.offsetHeight - contentHeight) / 2;\n  return {\n    scale: scale,\n    positionX: centerPositionX,\n    positionY: centerPositionY\n  };\n};\n\nvar isWheelAllowed = function (contextInstance, event) {\n  var _a = contextInstance.setup.wheel,\n      disabled = _a.disabled,\n      wheelDisabled = _a.wheelDisabled,\n      touchPadDisabled = _a.touchPadDisabled,\n      excluded = _a.excluded;\n  var isInitialized = contextInstance.isInitialized,\n      isPanning = contextInstance.isPanning;\n  var target = event.target;\n  var isAllowed = isInitialized && !isPanning && !disabled && target;\n  if (!isAllowed) return false; // Event ctrlKey detects if touchpad action is executing wheel or pinch gesture\n\n  if (wheelDisabled && !event.ctrlKey) return false;\n  if (touchPadDisabled && event.ctrlKey) return false;\n  var isExcluded = isExcludedNode(target, excluded);\n  if (isExcluded) return false;\n  return true;\n};\n\nfunction getDelta(event, customDelta) {\n  var deltaY = event ? event.deltaY < 0 ? 1 : -1 : 0;\n  var delta = checkIsNumber(customDelta, deltaY);\n  return delta;\n}\n\nfunction getMousePosition(event, contentComponent, scale) {\n  var contentRect = contentComponent.getBoundingClientRect();\n  var mouseX = 0;\n  var mouseY = 0;\n\n  if (\"clientX\" in event) {\n    // mouse position x, y over wrapper component\n    mouseX = (event.clientX - contentRect.left) / scale;\n    mouseY = (event.clientY - contentRect.top) / scale;\n  } else {\n    var touch = event.touches[0];\n    mouseX = (touch.clientX - contentRect.left) / scale;\n    mouseY = (touch.clientY - contentRect.top) / scale;\n  }\n\n  if (isNaN(mouseX) || isNaN(mouseY)) console.error(\"No mouse or touch offset found\");\n  return {\n    x: mouseX,\n    y: mouseY\n  };\n}\n\nvar handleCalculateWheelZoom = function (contextInstance, delta, step, disablePadding, getTarget) {\n  var scale = contextInstance.transformState.scale;\n  var wrapperComponent = contextInstance.wrapperComponent,\n      setup = contextInstance.setup;\n  var maxScale = setup.maxScale,\n      minScale = setup.minScale,\n      zoomAnimation = setup.zoomAnimation;\n  var size = zoomAnimation.size,\n      disabled = zoomAnimation.disabled;\n\n  if (!wrapperComponent) {\n    throw new Error(\"Wrapper is not mounted\");\n  }\n\n  var targetScale = scale + delta * (scale - scale * step) * step;\n  if (getTarget) return targetScale;\n  var paddingEnabled = disablePadding ? false : !disabled;\n  var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, paddingEnabled);\n  return newScale;\n};\n\nvar handleWheelZoomStop = function (contextInstance, event) {\n  var previousWheelEvent = contextInstance.previousWheelEvent;\n  var scale = contextInstance.transformState.scale;\n  var _a = contextInstance.setup,\n      maxScale = _a.maxScale,\n      minScale = _a.minScale;\n  if (!previousWheelEvent) return false;\n  if (scale < maxScale || scale > minScale) return true;\n  if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY)) return true;\n  if (previousWheelEvent.deltaY > 0 && previousWheelEvent.deltaY < event.deltaY) return true;\n  if (previousWheelEvent.deltaY < 0 && previousWheelEvent.deltaY > event.deltaY) return true;\n  if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY)) return true;\n  return false;\n};\n\nvar isPinchStartAllowed = function (contextInstance, event) {\n  var _a = contextInstance.setup.pinch,\n      disabled = _a.disabled,\n      excluded = _a.excluded;\n  var isInitialized = contextInstance.isInitialized;\n  var target = event.target;\n  var isAllowed = isInitialized && !disabled && target;\n  if (!isAllowed) return false;\n  var isExcluded = isExcludedNode(target, excluded);\n  if (isExcluded) return false;\n  return true;\n};\n\nvar isPinchAllowed = function (contextInstance) {\n  var disabled = contextInstance.setup.pinch.disabled;\n  var isInitialized = contextInstance.isInitialized,\n      pinchStartDistance = contextInstance.pinchStartDistance;\n  var isAllowed = isInitialized && !disabled && pinchStartDistance;\n  if (!isAllowed) return false;\n  return true;\n};\n\nvar calculateTouchMidPoint = function (event, scale, contentComponent) {\n  var contentRect = contentComponent.getBoundingClientRect();\n  var touches = event.touches;\n  var firstPointX = roundNumber(touches[0].clientX - contentRect.left, 5);\n  var firstPointY = roundNumber(touches[0].clientY - contentRect.top, 5);\n  var secondPointX = roundNumber(touches[1].clientX - contentRect.left, 5);\n  var secondPointY = roundNumber(touches[1].clientY - contentRect.top, 5);\n  return {\n    x: (firstPointX + secondPointX) / 2 / scale,\n    y: (firstPointY + secondPointY) / 2 / scale\n  };\n};\n\nvar getTouchDistance = function (event) {\n  return Math.sqrt(Math.pow(event.touches[0].pageX - event.touches[1].pageX, 2) + Math.pow(event.touches[0].pageY - event.touches[1].pageY, 2));\n};\n\nvar calculatePinchZoom = function (contextInstance, currentDistance) {\n  var pinchStartScale = contextInstance.pinchStartScale,\n      pinchStartDistance = contextInstance.pinchStartDistance,\n      setup = contextInstance.setup;\n  var maxScale = setup.maxScale,\n      minScale = setup.minScale,\n      zoomAnimation = setup.zoomAnimation;\n  var size = zoomAnimation.size,\n      disabled = zoomAnimation.disabled;\n\n  if (!pinchStartScale || pinchStartDistance === null || !currentDistance) {\n    throw new Error(\"Pinch touches distance was not provided\");\n  }\n\n  if (currentDistance < 0) {\n    return contextInstance.transformState.scale;\n  }\n\n  var touchProportion = currentDistance / pinchStartDistance;\n  var scaleDifference = touchProportion * pinchStartScale;\n  return checkZoomBounds(roundNumber(scaleDifference, 2), minScale, maxScale, size, !disabled);\n};\n\nvar wheelStopEventTime = 160;\nvar wheelAnimationTime = 100;\n\nvar handleWheelStart = function (contextInstance, event) {\n  var _a = contextInstance.props,\n      onWheelStart = _a.onWheelStart,\n      onZoomStart = _a.onZoomStart;\n\n  if (!contextInstance.wheelStopEventTimer) {\n    handleCancelAnimation(contextInstance);\n    handleCallback(getContext(contextInstance), event, onWheelStart);\n    handleCallback(getContext(contextInstance), event, onZoomStart);\n  }\n};\n\nvar handleWheelZoom = function (contextInstance, event) {\n  var _a = contextInstance.props,\n      onWheel = _a.onWheel,\n      onZoom = _a.onZoom;\n  var contentComponent = contextInstance.contentComponent,\n      setup = contextInstance.setup,\n      transformState = contextInstance.transformState;\n  var scale = transformState.scale;\n  var limitToBounds = setup.limitToBounds,\n      centerZoomedOut = setup.centerZoomedOut,\n      zoomAnimation = setup.zoomAnimation,\n      wheel = setup.wheel;\n  var size = zoomAnimation.size,\n      disabled = zoomAnimation.disabled;\n  var step = wheel.step;\n\n  if (!contentComponent) {\n    throw new Error(\"Component not mounted\");\n  }\n\n  event.preventDefault();\n  event.stopPropagation();\n  var delta = getDelta(event, null);\n  var newScale = handleCalculateWheelZoom(contextInstance, delta, step, !event.ctrlKey); // if scale not change\n\n  if (scale === newScale) return;\n  var bounds = handleCalculateBounds(contextInstance, newScale);\n  var mousePosition = getMousePosition(event, contentComponent, scale);\n  var isPaddingDisabled = disabled || size === 0 || centerZoomedOut;\n  var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n\n  var _b = handleCalculateZoomPositions(contextInstance, mousePosition.x, mousePosition.y, newScale, bounds, isLimitedToBounds),\n      x = _b.x,\n      y = _b.y;\n\n  contextInstance.previousWheelEvent = event;\n  contextInstance.setTransformState(newScale, x, y);\n  handleCallback(getContext(contextInstance), event, onWheel);\n  handleCallback(getContext(contextInstance), event, onZoom);\n};\n\nvar handleWheelStop = function (contextInstance, event) {\n  var _a = contextInstance.props,\n      onWheelStop = _a.onWheelStop,\n      onZoomStop = _a.onZoomStop; // fire animation\n\n  cancelTimeout(contextInstance.wheelAnimationTimer);\n  contextInstance.wheelAnimationTimer = setTimeout(function () {\n    if (!contextInstance.mounted) return;\n    handleAlignToScaleBounds(contextInstance, event.x, event.y);\n    contextInstance.wheelAnimationTimer = null;\n  }, wheelAnimationTime); // Wheel stop event\n\n  var hasStoppedZooming = handleWheelZoomStop(contextInstance, event);\n\n  if (hasStoppedZooming) {\n    cancelTimeout(contextInstance.wheelStopEventTimer);\n    contextInstance.wheelStopEventTimer = setTimeout(function () {\n      if (!contextInstance.mounted) return;\n      contextInstance.wheelStopEventTimer = null;\n      handleCallback(getContext(contextInstance), event, onWheelStop);\n      handleCallback(getContext(contextInstance), event, onZoomStop);\n    }, wheelStopEventTime);\n  }\n};\n\nvar handlePinchStart = function (contextInstance, event) {\n  var distance = getTouchDistance(event);\n  contextInstance.pinchStartDistance = distance;\n  contextInstance.lastDistance = distance;\n  contextInstance.pinchStartScale = contextInstance.transformState.scale;\n  contextInstance.isPanning = false;\n  handleCancelAnimation(contextInstance);\n};\n\nvar handlePinchZoom = function (contextInstance, event) {\n  var contentComponent = contextInstance.contentComponent,\n      pinchStartDistance = contextInstance.pinchStartDistance;\n  var scale = contextInstance.transformState.scale;\n  var _a = contextInstance.setup,\n      limitToBounds = _a.limitToBounds,\n      centerZoomedOut = _a.centerZoomedOut,\n      zoomAnimation = _a.zoomAnimation;\n  var disabled = zoomAnimation.disabled,\n      size = zoomAnimation.size; // if one finger starts from outside of wrapper\n\n  if (pinchStartDistance === null || !contentComponent) return;\n  var midPoint = calculateTouchMidPoint(event, scale, contentComponent); // if touches goes off of the wrapper element\n\n  if (!isFinite(midPoint.x) || !isFinite(midPoint.y)) return;\n  var currentDistance = getTouchDistance(event);\n  var newScale = calculatePinchZoom(contextInstance, currentDistance);\n  if (newScale === scale) return;\n  var bounds = handleCalculateBounds(contextInstance, newScale);\n  var isPaddingDisabled = disabled || size === 0 || centerZoomedOut;\n  var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n\n  var _b = handleCalculateZoomPositions(contextInstance, midPoint.x, midPoint.y, newScale, bounds, isLimitedToBounds),\n      x = _b.x,\n      y = _b.y;\n\n  contextInstance.pinchMidpoint = midPoint;\n  contextInstance.lastDistance = currentDistance;\n  contextInstance.setTransformState(newScale, x, y);\n};\n\nvar handlePinchStop = function (contextInstance) {\n  var pinchMidpoint = contextInstance.pinchMidpoint;\n  contextInstance.velocity = null;\n  contextInstance.lastDistance = null;\n  contextInstance.pinchMidpoint = null;\n  contextInstance.pinchStartScale = null;\n  contextInstance.pinchStartDistance = null;\n  handleAlignToScaleBounds(contextInstance, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.x, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.y);\n};\n\nfunction handleDoubleClick(contextInstance, event) {\n  var _a = contextInstance.setup.doubleClick,\n      disabled = _a.disabled,\n      mode = _a.mode,\n      step = _a.step,\n      animationTime = _a.animationTime,\n      animationType = _a.animationType;\n  if (disabled) return;\n\n  if (mode === \"reset\") {\n    return resetTransformations(contextInstance, animationTime, animationType);\n  }\n\n  var scale = contextInstance.transformState.scale;\n  var contentComponent = contextInstance.contentComponent;\n  if (!contentComponent) return console.error(\"No ContentComponent found\");\n  var delta = mode === \"zoomOut\" ? -1 : 1;\n  var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n  var mousePosition = getMousePosition(event, contentComponent, scale);\n  var targetState = handleZoomToPoint(contextInstance, newScale, mousePosition.x, mousePosition.y);\n\n  if (!targetState) {\n    return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n  }\n\n  animate(contextInstance, targetState, animationTime, animationType);\n}\n\nvar isDoubleClickAllowed = function (contextInstance, event) {\n  var isInitialized = contextInstance.isInitialized,\n      setup = contextInstance.setup,\n      wrapperComponent = contextInstance.wrapperComponent;\n  var _a = setup.doubleClick,\n      disabled = _a.disabled,\n      excluded = _a.excluded;\n  var target = event.target;\n  var isWrapperChild = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n  var isAllowed = isInitialized && target && isWrapperChild && !disabled;\n  if (!isAllowed) return false;\n  var isExcluded = isExcludedNode(target, excluded);\n  if (isExcluded) return false;\n  if (!isAllowed) return false;\n  return true;\n};\n\nvar Context = React.createContext(contextInitialState);\n\nvar TransformContext =\n/** @class */\nfunction (_super) {\n  __extends(TransformContext, _super);\n\n  function TransformContext() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.mounted = true;\n    _this.transformState = createState(_this.props);\n    _this.setup = createSetup(_this.props); // Components\n\n    _this.wrapperComponent = null;\n    _this.contentComponent = null; // Initialization\n\n    _this.isInitialized = false;\n    _this.bounds = null; // wheel helpers\n\n    _this.previousWheelEvent = null;\n    _this.wheelStopEventTimer = null;\n    _this.wheelAnimationTimer = null; // panning helpers\n\n    _this.isPanning = false;\n    _this.startCoords = null;\n    _this.lastTouch = null; // pinch helpers\n\n    _this.distance = null;\n    _this.lastDistance = null;\n    _this.pinchStartDistance = null;\n    _this.pinchStartScale = null;\n    _this.pinchMidpoint = null; // velocity helpers\n\n    _this.velocity = null;\n    _this.velocityTime = null;\n    _this.lastMousePosition = null; // animations helpers\n\n    _this.animate = false;\n    _this.animation = null;\n    _this.maxBounds = null; // key press\n\n    _this.pressedKeys = {};\n\n    _this.handleInitializeWrapperEvents = function (wrapper) {\n      // Zooming events on wrapper\n      var passive = makePassiveEventOption();\n      wrapper.addEventListener(\"wheel\", _this.onWheelZoom, passive);\n      wrapper.addEventListener(\"dblclick\", _this.onDoubleClick, passive);\n      wrapper.addEventListener(\"touchstart\", _this.onTouchPanningStart, passive);\n      wrapper.addEventListener(\"touchmove\", _this.onTouchPanning, passive);\n      wrapper.addEventListener(\"touchend\", _this.onTouchPanningStop, passive);\n    };\n\n    _this.handleInitialize = function () {\n      var centerOnInit = _this.setup.centerOnInit;\n\n      _this.applyTransformation();\n\n      _this.forceUpdate();\n\n      if (centerOnInit) {\n        // this has to be redone once the right solution is found\n        // problem is - we need to execute it after mounted component specify it's height / width, images are fetched async so it's tricky\n        setTimeout(function () {\n          if (_this.mounted) {\n            _this.setCenter();\n          }\n        }, 50);\n        setTimeout(function () {\n          if (_this.mounted) {\n            _this.setCenter();\n          }\n        }, 100);\n        setTimeout(function () {\n          if (_this.mounted) {\n            _this.setCenter();\n          }\n        }, 200);\n      }\n    }; //////////\n    // Zoom\n    //////////\n\n\n    _this.onWheelZoom = function (event) {\n      var disabled = _this.setup.disabled;\n      if (disabled) return;\n      var isAllowed = isWheelAllowed(_this, event);\n      if (!isAllowed) return;\n\n      var keysPressed = _this.isPressingKeys(_this.setup.wheel.activationKeys);\n\n      if (!keysPressed) return;\n      handleWheelStart(_this, event);\n      handleWheelZoom(_this, event);\n      handleWheelStop(_this, event);\n    }; //////////\n    // Pan\n    //////////\n\n\n    _this.onPanningStart = function (event) {\n      var disabled = _this.setup.disabled;\n      var onPanningStart = _this.props.onPanningStart;\n      if (disabled) return;\n      var isAllowed = isPanningStartAllowed(_this, event);\n      if (!isAllowed) return;\n\n      var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n\n      if (!keysPressed) return;\n      event.preventDefault();\n      event.stopPropagation();\n      handleCancelAnimation(_this);\n      handlePanningStart(_this, event);\n      handleCallback(getContext(_this), event, onPanningStart);\n    };\n\n    _this.onPanning = function (event) {\n      var disabled = _this.setup.disabled;\n      var onPanning = _this.props.onPanning;\n      if (disabled) return;\n      var isAllowed = isPanningAllowed(_this);\n      if (!isAllowed) return;\n\n      var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n\n      if (!keysPressed) return;\n      event.preventDefault();\n      event.stopPropagation();\n      handlePanning(_this, event.clientX, event.clientY);\n      handleCallback(getContext(_this), event, onPanning);\n    };\n\n    _this.onPanningStop = function (event) {\n      var onPanningStop = _this.props.onPanningStop;\n\n      if (_this.isPanning) {\n        handlePanningEnd(_this);\n        handleCallback(getContext(_this), event, onPanningStop);\n      }\n    }; //////////\n    // Pinch\n    //////////\n\n\n    _this.onPinchStart = function (event) {\n      var disabled = _this.setup.disabled;\n      var _a = _this.props,\n          onPinchingStart = _a.onPinchingStart,\n          onZoomStart = _a.onZoomStart;\n      if (disabled) return;\n      var isAllowed = isPinchStartAllowed(_this, event);\n      if (!isAllowed) return;\n      handlePinchStart(_this, event);\n      handleCancelAnimation(_this);\n      handleCallback(getContext(_this), event, onPinchingStart);\n      handleCallback(getContext(_this), event, onZoomStart);\n    };\n\n    _this.onPinch = function (event) {\n      var disabled = _this.setup.disabled;\n      var _a = _this.props,\n          onPinching = _a.onPinching,\n          onZoom = _a.onZoom;\n      if (disabled) return;\n      var isAllowed = isPinchAllowed(_this);\n      if (!isAllowed) return;\n      event.preventDefault();\n      event.stopPropagation();\n      handlePinchZoom(_this, event);\n      handleCallback(getContext(_this), event, onPinching);\n      handleCallback(getContext(_this), event, onZoom);\n    };\n\n    _this.onPinchStop = function (event) {\n      var _a = _this.props,\n          onPinchingStop = _a.onPinchingStop,\n          onZoomStop = _a.onZoomStop;\n\n      if (_this.pinchStartScale) {\n        handlePinchStop(_this);\n        handleCallback(getContext(_this), event, onPinchingStop);\n        handleCallback(getContext(_this), event, onZoomStop);\n      }\n    }; //////////\n    // Touch\n    //////////\n\n\n    _this.onTouchPanningStart = function (event) {\n      var disabled = _this.setup.disabled;\n      var onPanningStart = _this.props.onPanningStart;\n      if (disabled) return;\n      var isAllowed = isPanningStartAllowed(_this, event);\n      if (!isAllowed) return;\n      var isDoubleTap = _this.lastTouch && +new Date() - _this.lastTouch < 200;\n\n      if (isDoubleTap && event.touches.length === 1) {\n        _this.onDoubleClick(event);\n      } else {\n        _this.lastTouch = +new Date();\n        handleCancelAnimation(_this);\n        var touches = event.touches;\n        var isPanningAction = touches.length === 1;\n        var isPinchAction = touches.length === 2;\n\n        if (isPanningAction) {\n          handleCancelAnimation(_this);\n          handlePanningStart(_this, event);\n          handleCallback(getContext(_this), event, onPanningStart);\n        }\n\n        if (isPinchAction) {\n          _this.onPinchStart(event);\n        }\n      }\n    };\n\n    _this.onTouchPanning = function (event) {\n      var disabled = _this.setup.disabled;\n      var onPanning = _this.props.onPanning;\n\n      if (_this.isPanning && event.touches.length === 1) {\n        if (disabled) return;\n        var isAllowed = isPanningAllowed(_this);\n        if (!isAllowed) return;\n        event.preventDefault();\n        event.stopPropagation();\n        var touch = event.touches[0];\n        handlePanning(_this, touch.clientX, touch.clientY);\n        handleCallback(getContext(_this), event, onPanning);\n      } else if (event.touches.length > 1) {\n        _this.onPinch(event);\n      }\n    };\n\n    _this.onTouchPanningStop = function (event) {\n      _this.onPanningStop(event);\n\n      _this.onPinchStop(event);\n    }; //////////\n    // Double Click\n    //////////\n\n\n    _this.onDoubleClick = function (event) {\n      var disabled = _this.setup.disabled;\n      if (disabled) return;\n      var isAllowed = isDoubleClickAllowed(_this, event);\n      if (!isAllowed) return;\n      handleDoubleClick(_this, event);\n    }; //////////\n    // Helpers\n    //////////\n\n\n    _this.clearPanning = function (event) {\n      if (_this.isPanning) {\n        _this.onPanningStop(event);\n      }\n    };\n\n    _this.setKeyPressed = function (e) {\n      _this.pressedKeys[e.key] = true;\n    };\n\n    _this.setKeyUnPressed = function (e) {\n      _this.pressedKeys[e.key] = false;\n    };\n\n    _this.isPressingKeys = function (keys) {\n      if (!keys.length) {\n        return true;\n      }\n\n      return Boolean(keys.find(function (key) {\n        return _this.pressedKeys[key];\n      }));\n    };\n\n    _this.setComponents = function (wrapperComponent, contentComponent) {\n      _this.wrapperComponent = wrapperComponent;\n      _this.contentComponent = contentComponent;\n      handleCalculateBounds(_this, _this.transformState.scale);\n\n      _this.handleInitializeWrapperEvents(wrapperComponent);\n\n      _this.handleInitialize();\n\n      _this.handleRef();\n\n      _this.isInitialized = true;\n      handleCallback(getContext(_this), undefined, _this.props.onInit);\n    };\n\n    _this.setTransformState = function (scale, positionX, positionY) {\n      if (!isNaN(scale) && !isNaN(positionX) && !isNaN(positionY)) {\n        if (scale !== _this.transformState.scale) {\n          _this.transformState.previousScale = _this.transformState.scale;\n          _this.transformState.scale = scale;\n        }\n\n        _this.transformState.positionX = positionX;\n        _this.transformState.positionY = positionY;\n\n        _this.applyTransformation();\n      } else {\n        console.error(\"Detected NaN set state values\");\n      }\n    };\n\n    _this.setCenter = function () {\n      if (_this.wrapperComponent && _this.contentComponent) {\n        var targetState = getCenterPosition(_this.transformState.scale, _this.wrapperComponent, _this.contentComponent);\n\n        _this.setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n      }\n    };\n\n    _this.applyTransformation = function () {\n      if (!_this.mounted || !_this.contentComponent) return;\n      var _a = _this.transformState,\n          scale = _a.scale,\n          positionX = _a.positionX,\n          positionY = _a.positionY;\n      var transform = getTransformStyles(positionX, positionY, scale);\n      _this.contentComponent.style.transform = transform;\n\n      _this.handleRef();\n    };\n\n    _this.handleRef = function () {\n      _this.props.setRef(getContext(_this));\n    };\n\n    return _this;\n  }\n\n  TransformContext.prototype.componentDidMount = function () {\n    var passive = makePassiveEventOption(); // Panning on window to allow panning when mouse is out of component wrapper\n\n    window.addEventListener(\"mousedown\", this.onPanningStart, passive);\n    window.addEventListener(\"mousemove\", this.onPanning, passive);\n    window.addEventListener(\"mouseup\", this.onPanningStop, passive);\n    document.addEventListener(\"mouseleave\", this.clearPanning, passive);\n    window.addEventListener(\"keyup\", this.setKeyUnPressed, passive);\n    window.addEventListener(\"keydown\", this.setKeyPressed, passive);\n    this.handleRef();\n  };\n\n  TransformContext.prototype.componentWillUnmount = function () {\n    var passive = makePassiveEventOption();\n    window.removeEventListener(\"mousedown\", this.onPanningStart, passive);\n    window.removeEventListener(\"mousemove\", this.onPanning, passive);\n    window.removeEventListener(\"mouseup\", this.onPanningStop, passive);\n    window.removeEventListener(\"keyup\", this.setKeyUnPressed, passive);\n    window.removeEventListener(\"keydown\", this.setKeyPressed, passive);\n    handleCancelAnimation(this);\n  };\n\n  TransformContext.prototype.componentDidUpdate = function (oldProps) {\n    if (oldProps !== this.props) {\n      handleCalculateBounds(this, this.transformState.scale);\n      this.setup = createSetup(this.props);\n    }\n  };\n\n  TransformContext.prototype.render = function () {\n    var value = getContext(this);\n    var children = this.props.children;\n    var content = typeof children === \"function\" ? children(value) : children;\n    return React.createElement(Context.Provider, {\n      value: __assign(__assign({}, this.transformState), {\n        setComponents: this.setComponents,\n        contextInstance: this\n      })\n    }, content);\n  };\n\n  return TransformContext;\n}(Component);\n\nvar TransformWrapper = React.forwardRef(function (props, ref) {\n  var _a = useState(null),\n      innerRef = _a[0],\n      setRef = _a[1];\n\n  useImperativeHandle(ref, function () {\n    return innerRef;\n  }, [innerRef]);\n  return React.createElement(TransformContext, __assign({}, props, {\n    setRef: setRef\n  }));\n});\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".transform-component-module_wrapper__1_Fgj {\\n  position: relative;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  overflow: hidden;\\n  -webkit-touch-callout: none; /* iOS Safari */\\n  -webkit-user-select: none; /* Safari */\\n  -khtml-user-select: none; /* Konqueror HTML */\\n  -moz-user-select: none; /* Firefox */\\n  -ms-user-select: none; /* Internet Explorer/Edge */\\n  user-select: none;\\n  margin: 0;\\n  padding: 0;\\n}\\n.transform-component-module_content__2jYgh {\\n  display: flex;\\n  flex-wrap: wrap;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  margin: 0;\\n  padding: 0;\\n  transform-origin: 0% 0%;\\n}\\n.transform-component-module_content__2jYgh img {\\n  pointer-events: none;\\n}\\n\";\nvar styles = {\n  \"wrapper\": \"transform-component-module_wrapper__1_Fgj\",\n  \"content\": \"transform-component-module_content__2jYgh\"\n};\nstyleInject(css_248z);\n\nvar TransformComponent = function (_a) {\n  var children = _a.children,\n      _b = _a.wrapperClass,\n      wrapperClass = _b === void 0 ? \"\" : _b,\n      _c = _a.contentClass,\n      contentClass = _c === void 0 ? \"\" : _c,\n      wrapperStyle = _a.wrapperStyle,\n      contentStyle = _a.contentStyle;\n  var setComponents = useContext(Context).setComponents;\n  var wrapperRef = useRef(null);\n  var contentRef = useRef(null);\n  useEffect(function () {\n    var wrapper = wrapperRef.current;\n    var content = contentRef.current;\n\n    if (wrapper !== null && content !== null && setComponents) {\n      setComponents(wrapper, content);\n    }\n  }, []);\n  return React.createElement(\"div\", {\n    ref: wrapperRef,\n    className: \"react-transform-wrapper \" + styles.wrapper + \" \" + wrapperClass,\n    style: wrapperStyle\n  }, React.createElement(\"div\", {\n    ref: contentRef,\n    className: \"react-transform-component \" + styles.content + \" \" + contentClass,\n    style: contentStyle\n  }, children));\n};\n\nvar useTransformContext = function () {\n  var libraryContext = useContext(Context);\n\n  if (!libraryContext.contextInstance) {\n    throw new Error(\"Transform context mus be placed inside TransformWrapper\");\n  }\n\n  return getContext(libraryContext.contextInstance);\n};\n\nexport { TransformComponent, TransformWrapper, useTransformContext };","map":{"version":3,"mappings":"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","names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArray","to","from","pack","l","ar","slice","concat","roundNumber","num","decimal","Number","toFixed","checkIsNumber","defaultValue","handleCallback","context","event","callback","easeOut","Math","cos","PI","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","animations","handleCancelAnimationFrame","animation","cancelAnimationFrame","handleCancelAnimation","contextInstance","mounted","animate","velocity","handleSetupAnimation","animationName","animationTime","startTime","Date","getTime","lastStep","frameTime","animationProgress","animationType","step","requestAnimationFrame","targetState","isValid","isValidTargetState","transformState","scale","positionX","positionY","scaleDiff","positionXDiff","positionYDiff","setTransformState","newScale","newPositionX","newPositionY","isNaN","getComponentsSizes","wrapperComponent","contentComponent","wrapperWidth","offsetWidth","wrapperHeight","offsetHeight","contentWidth","contentHeight","newContentWidth","newContentHeight","newDiffWidth","newDiffHeight","getBounds","diffWidth","diffHeight","centerZoomedOut","scaleWidthFactor","scaleHeightFactor","minPositionX","maxPositionX","minPositionY","maxPositionY","calculateBounds","setup","Error","bounds","Boolean","handleCalculateBounds","getMouseBoundedPosition","limitToBounds","paddingValueX","paddingValueY","paddingX","paddingY","x","boundLimiter","y","value","minBound","maxBound","isActive","handleCalculateZoomPositions","mouseX","mouseY","scaleDifference","console","error","calculatedPositionX","calculatedPositionY","newPositions","checkZoomBounds","zoom","minScale","maxScale","zoomPadding","enablePadding","scalePadding","minScaleWithPadding","isPanningStartAllowed","panning","excluded","target","isWrapperChild","contains","isAllowed","isInitialized","isExcluded","isExcludedNode","isPanningAllowed","isPanning","disabled","handlePanningSetup","clientX","clientY","startCoords","handleTouchPanningSetup","touches","oneFingerTouch","handlePanToBounds","xChanged","yChanged","mousePosX","mousePosY","handleNewPosition","hasPositionXChanged","hasPositionYChanged","hasNewPosition","getPanningClientPosition","lockAxisY","lockAxisX","getPaddingValue","size","isVelocityCalculationAllowed","velocityAnimation","disabledVelocity","isVelocityAllowed","getVelocityMoveTime","sensitivity","equalToMove","getVelocityPosition","newPosition","startPosition","currentPosition","isLocked","minPosition","maxPosition","minTarget","maxTarget","calculatedPosition","getSizeMultiplier","defaultMultiplier","min","window","innerWidth","handleCalculateVelocity","position","velocityTime","now","lastMousePosition","sizeMultiplier","distanceX","distanceY","velocityX","velocityY","interval","speed","sqrt","total","handleVelocityPanning","alignmentAnimation","zoomAnimation","sizeY","velocityAlignmentTime","alignAnimationTime","moveAnimationTime","finalAnimationTime","max","sizeX","maxTargetX","minTargetX","maxTargetY","minTargetY","startState","alignAnimation","alignStep","customStep","currentPositionX","currentPositionY","handlePanningStart","handlePanning","handlePanningEnd","velocityDisabled","wrapperRect","getBoundingClientRect","contentRect","width","height","isZoomed","shouldAnimate","handleAlignToBounds","isDisabled","handleAlignToScaleBounds","mousePositionX","mousePositionY","handleZoomToPoint","initialState","previousScale","contextInitialState","setComponents","initialSetup","centerOnInit","wheel","wheelDisabled","touchPadDisabled","activationKeys","pinch","doubleClick","mode","createState","props","initialScale","_a","_b","initialPositionX","_c","initialPositionY","_d","createSetup","newSetup","keys","forEach","key","validValue","validParameter","dataType","toString","isObject","isArray","handleCalculateButtonZoom","delta","targetScale","exp","handleZoomToViewCenter","resetTransformations","initialTransformation","newBounds","boundedPositions","newState","calculateZoomToNode","node","customZoom","nodeRect","getOffset","nodeLeft","nodeTop","nodeWidth","nodeHeight","scaleX","scaleY","offsetX","offsetY","left","top","element","el","offsetLeft","offsetTop","offsetParent","isValidZoomNode","undefined","zoomIn","zoomOut","setTransform","resetTransform","centerView","getCenterPosition","zoomToElement","document","getElementById","getContext","instance","state","passiveSupported","makePassiveEventOption","options","passive","err","targetTagName","tagName","toUpperCase","isExcludedTag","find","tag","isExcludedClassName","className","classList","cancelTimeout","timeout","clearTimeout","getTransformStyles","centerPositionX","centerPositionY","isWheelAllowed","ctrlKey","getDelta","customDelta","deltaY","getMousePosition","touch","handleCalculateWheelZoom","disablePadding","getTarget","paddingEnabled","handleWheelZoomStop","previousWheelEvent","sign","isPinchStartAllowed","isPinchAllowed","pinchStartDistance","calculateTouchMidPoint","firstPointX","firstPointY","secondPointX","secondPointY","getTouchDistance","pow","pageX","pageY","calculatePinchZoom","currentDistance","pinchStartScale","touchProportion","wheelStopEventTime","wheelAnimationTime","handleWheelStart","onWheelStart","onZoomStart","wheelStopEventTimer","handleWheelZoom","onWheel","onZoom","preventDefault","stopPropagation","mousePosition","isPaddingDisabled","isLimitedToBounds","handleWheelStop","onWheelStop","onZoomStop","wheelAnimationTimer","setTimeout","hasStoppedZooming","handlePinchStart","distance","lastDistance","handlePinchZoom","midPoint","isFinite","pinchMidpoint","handlePinchStop","handleDoubleClick","isDoubleClickAllowed","Context","React","createContext","_this","wrapper","addEventListener","onWheelZoom","onDoubleClick","onTouchPanningStart","onTouchPanning","onTouchPanningStop","applyTransformation","forceUpdate","setCenter","keysPressed","isPressingKeys","onPanningStart","onPanning","onPanningStop","onPinchingStart","onPinching","onPinchingStop","isDoubleTap","lastTouch","isPanningAction","isPinchAction","onPinchStart","onPinch","onPinchStop","e","pressedKeys","handleInitializeWrapperEvents","handleInitialize","handleRef","onInit","transform","style","setRef","TransformContext","clearPanning","setKeyUnPressed","setKeyPressed","removeEventListener","oldProps","children","content","Provider","Component","TransformWrapper","forwardRef","ref","useState","innerRef","useImperativeHandle","styleInject","css","insertAt","head","getElementsByTagName","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","TransformComponent","wrapperClass","contentClass","wrapperStyle","contentStyle","useContext","wrapperRef","useRef","contentRef","useEffect","current","styles","useTransformContext","libraryContext"],"sources":["../node_modules/tslib/tslib.es6.js","../src/utils/calculations.utils.ts","../src/utils/callback.utils.ts","../src/core/animations/animations.constants.ts","../src/core/animations/animations.utils.ts","../src/core/bounds/bounds.utils.ts","../src/core/zoom/zoom.utils.ts","../src/core/pan/panning.utils.ts","../src/core/pan/velocity.utils.ts","../src/core/pan/velocity.logic.ts","../src/core/pan/panning.logic.ts","../src/core/zoom/zoom.logic.ts","../src/constants/state.constants.ts","../src/utils/state.utils.ts","../src/core/handlers/handlers.utils.ts","../src/core/handlers/handlers.logic.ts","../src/utils/context.utils.ts","../src/utils/event.utils.ts","../src/utils/helpers.utils.ts","../src/utils/styles.utils.ts","../src/core/wheel/wheel.utils.ts","../src/core/pinch/pinch.utils.ts","../src/core/wheel/wheel.logic.ts","../src/core/pinch/pinch.logic.ts","../src/core/double-click/double-click.logic.ts","../src/components/transform-context.tsx","../src/components/transform-wrapper.tsx","../node_modules/style-inject/dist/style-inject.es.js","../src/components/transform-component.tsx","../src/hooks/use-transform-context.tsx"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n",null,null]},"metadata":{},"sourceType":"module"}